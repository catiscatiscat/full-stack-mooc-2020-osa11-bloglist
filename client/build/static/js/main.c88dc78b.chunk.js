(this.webpackJsonpundefined=this.webpackJsonpundefined||[]).push([[0],{18:function(e,t,n){e.exports=n(44)},43:function(e,t,n){},44:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(17),u=n.n(c),l=n(5),o=n(1),s=n.n(o),i=n(4),d=n(2),m=n(7),p=n.n(m),b=function(e){var t=e.blog,n=e.updateBlog,c=e.deleteBlog,u=e.username,l=Object(a.useState)(!1),o=Object(d.a)(l,2),s=o[0],i=o[1],m=u===t.user.username,p="Really want to remove blog ".concat(t.title," by ").concat(t.author,"?");return r.a.createElement("div",{className:"blog"},r.a.createElement("div",{id:"blog-basic-info"},t.title," ",t.author," ",r.a.createElement("button",{id:"view-hide-btn",type:"button",onClick:function(){i(!s)}},s?"hide":"view")),r.a.createElement(r.a.Fragment,null,s&&r.a.createElement(r.a.Fragment,null,r.a.createElement("div",null,t.url),r.a.createElement("div",{id:"likes"}," ","Likes ",t.likes," ",r.a.createElement("button",{id:"like-btn",className:"likeBtn",type:"button",onClick:function(){n({id:t.id,title:t.title,author:t.author,url:t.url,likes:t.likes+1,user:t.user.id})}},"Like")),r.a.createElement("div",null,t.user.name),m&&r.a.createElement("button",{id:"remove-btn",className:"removeBtn",type:"button",onClick:function(){window.confirm(p)&&c({id:t.id,title:t.title})}},"remove"))))},g=function(e){var t=e.createBlog,n=Object(a.useState)(""),c=Object(d.a)(n,2),u=c[0],l=c[1],o=Object(a.useState)(""),s=Object(d.a)(o,2),i=s[0],m=s[1],p=Object(a.useState)(""),b=Object(d.a)(p,2),g=b[0],f=b[1];return r.a.createElement("div",null,r.a.createElement("h3",null,"create new"),r.a.createElement("form",{onSubmit:function(e){e.preventDefault(),t({title:i,author:u,url:g}),m(""),l(""),f("")},className:"blogForm"},r.a.createElement("label",null,"title ",r.a.createElement("input",{id:"title",value:i,onChange:function(e){m(e.target.value)}})),r.a.createElement("label",null,"Author ",r.a.createElement("input",{id:"author",value:u,onChange:function(e){l(e.target.value)}})),r.a.createElement("label",null,"url ",r.a.createElement("input",{id:"url",value:g,onChange:function(e){f(e.target.value)}})),r.a.createElement("button",{className:"createBtn",type:"submit"},"create")))},f=function(e){var t=e.submitHandler,n=e.username,a=e.password,c=e.handleNameChange,u=e.handlePasswordChange;return r.a.createElement(r.a.Fragment,null,r.a.createElement("form",{onSubmit:t},r.a.createElement("div",null,"username",r.a.createElement("input",{id:"username-input",type:"text",value:n,name:"Username",onChange:c})),r.a.createElement("div",null,"password",r.a.createElement("input",{id:"password-input",type:"password",value:a,name:"Password",onChange:u})),r.a.createElement("button",{id:"login-btn",type:"submit"},"login")))},v=function(e){var t=e.message,n={background:"lightgrey",fontSize:20,border:1,borderRadius:5,padding:10,marginBottom:10},a=Object(l.a)(Object(l.a)({},n),{},{color:"green"}),c=Object(l.a)(Object(l.a)({},n),{},{color:"red"});return null===t?null:"success"===t.type?r.a.createElement("div",null,r.a.createElement("div",{id:"success",style:a},t.message)):"error"===t.type?r.a.createElement("div",null,r.a.createElement("div",{id:"error",style:c},t.message)):r.a.createElement(r.a.Fragment,null)},h=r.a.forwardRef((function(e,t){var n=Object(a.useState)(!1),c=Object(d.a)(n,2),u=c[0],l=c[1],o={display:u?"none":""},s={display:u?"":"none"},i=function(){l(!u)};return Object(a.useImperativeHandle)(t,(function(){return{toggleVisibility:i}})),r.a.createElement("div",null,r.a.createElement("div",{style:o},r.a.createElement("button",{id:e.buttonId,type:"button",onClick:i},e.buttonLabel)),r.a.createElement("div",{style:s},e.children," ",r.a.createElement("button",{type:"button",onClick:i},"cancel")))}));h.displayName="Togglable";var E=h,y=function(e){var t=e.handleLogout,n=e.username;return r.a.createElement("div",{className:"user"},r.a.createElement("p",{className:"userText"},n," is logged in"),r.a.createElement("button",{id:"logout-btn",className:"logoutBtn",type:"button",onClick:t},"logout"))},w=n(6),O=n.n(w),k=null,j={setToken:function(e){k="bearer ".concat(e)},getAll:function(){return O.a.get("/api/blogs").then((function(e){return e.data}))},create:function(){var e=Object(i.a)(s.a.mark((function e(t){var n,a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:k}},e.next=3,O.a.post("/api/blogs",t,n);case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),update:function(){var e=Object(i.a)(s.a.mark((function e(t){var n,a,r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:k}},a="".concat("/api/blogs","/").concat(t.id),e.next=4,O.a.put(a,t,n);case 4:return r=e.sent,e.abrupt("return",r.data);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),delBlog:function(){var e=Object(i.a)(s.a.mark((function e(t){var n,a,r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:k}},a="".concat("/api/blogs","/").concat(t),e.next=4,O.a.delete(a,n);case 4:return r=e.sent,e.abrupt("return",r.status);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},x={login:function(){var e=Object(i.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.a.post("/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},B=(n(43),function(){var e=Object(a.useState)([]),t=Object(d.a)(e,2),n=t[0],c=t[1],u=Object(a.useState)(""),o=Object(d.a)(u,2),m=o[0],h=o[1],w=Object(a.useState)(null),O=Object(d.a)(w,2),k=O[0],B=O[1],S=Object(a.useState)(""),C=Object(d.a)(S,2),N=C[0],A=C[1],F=Object(a.useState)(null),I=Object(d.a)(F,2),T=I[0],L=I[1],z=Object(a.useRef)(),J=function(e){setTimeout((function(){L(null)}),e)};Object(a.useEffect)((function(){k&&function(){var e=Object(i.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,j.getAll();case 3:t=e.sent,t=p.a.orderBy(t,["likes","title"],["desc","asc"]),c(t),L({message:"Blogs succesfully loaded from server",type:"success"}),J(3e3),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(0),L({message:"Failed to get blogs from server",type:"error"}),J(3e3);case 14:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(){return e.apply(this,arguments)}}()()}),[k]),Object(a.useEffect)((function(){var e=window.localStorage.getItem("loggedBlogAppUser");if(e){var t=JSON.parse(e);B(t),j.setToken(t.token)}}),[]);var R=function(){var e=Object(i.a)(s.a.mark((function e(t){var a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,z.current.toggleVisibility(),e.next=4,j.create(t);case 4:a=e.sent,a=Object(l.a)(Object(l.a)({},a),{},{user:{name:k.name,username:k.username}}),c(n.concat(a)),L({message:"a new blog ".concat(a.title," by ").concat(a.author," added"),type:"success"}),J(3e3),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(0),L({message:"failed to add a new blog",type:"error"}),J(3e3);case 15:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(t){return e.apply(this,arguments)}}(),U=function(){var e=Object(i.a)(s.a.mark((function e(t){var a,r,u;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,j.update(t);case 3:a=e.sent,r=p.a.find(n,(function(e){return e.id===a.id})),r=Object(l.a)(Object(l.a)({},r),{},{likes:a.likes}),u=p()(n).filter((function(e){return e.id!==a.id})).concat(r).orderBy(["likes","title"],["desc","asc"]).value(),c(u),L({message:"blog's ".concat(a.title," likes updated"),type:"success"}),J(3e3),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(0),L({message:"failed to update blog",type:"error"}),J(3e3);case 16:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(t){return e.apply(this,arguments)}}(),H=function(){var e=Object(i.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,j.delBlog(t.id);case 3:c(p.a.filter(n,(function(e){return e.id!==t.id}))),L({message:"blog ".concat(t.title," deleted"),type:"success"}),J(3e3),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),L({message:"failed to delete blog",type:"error"}),J(3e3);case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}(),P=function(){var e=Object(i.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,x.login({username:N,password:m});case 4:n=e.sent,window.localStorage.setItem("loggedBlogAppUser",JSON.stringify(n)),j.setToken(n.token),A(""),h(""),L({message:"".concat(n.name," logged in"),type:"success"}),J(3e3),setTimeout((function(){B(n)}),3e3),e.next=18;break;case 14:e.prev=14,e.t0=e.catch(1),L({message:"wrong username or password",type:"error"}),J(3e3);case 18:case"end":return e.stop()}}),e,null,[[1,14]])})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement("div",null,r.a.createElement(v,{message:T}),null===k?r.a.createElement(r.a.Fragment,null,r.a.createElement("h2",null,"log in to application"),r.a.createElement(f,{username:N,password:m,handleNameChange:function(e){A(e.target.value)},handlePasswordChange:function(e){h(e.target.value)},submitHandler:P})):r.a.createElement(r.a.Fragment,null,r.a.createElement("h2",null,"blogs"),r.a.createElement(y,{username:k.name,handleLogout:function(){B(null),window.localStorage.removeItem("loggedBlogAppUser")}}),r.a.createElement(E,{buttonId:"create-btn",buttonLabel:"create a new blog",ref:z},r.a.createElement(g,{createBlog:R})),r.a.createElement("div",{id:"blogs",className:"form"},n.map((function(e){return r.a.createElement(b,{key:e.id,blog:e,updateBlog:U,deleteBlog:H,username:k.username})})))))});u.a.render(r.a.createElement(B,null),document.getElementById("root"))}},[[18,1,2]]]);
//# sourceMappingURL=main.c88dc78b.chunk.js.map